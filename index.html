<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İPC Hesaplayıcı</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; box-shadow: 0 1px 3px rgba(0,0,0,0.12); }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #4CAF50; color: white; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }
        .ipc-input { width: 150px; padding: 6px; border: 1px solid #ccc; border-radius: 14px; text-align: center; font-size: larger; font-weight: bold; }
        .highlight { background-color: #e8f5e9; font-weight: bold; text-align: center; }
        .currency { color: #2e7d32; }
    </style>
</head>
<body>
    <h2 style="color: #2e7d32; margin-bottom: 20px;">Yeniden Değerleme Oranları (2000-2025)</h2>
    <table>
        <thead>
            <tr>
                <th>Yıl</th>
                <th>Artış Oranı (%)</th>
                <th>İPC Tutarı (₺)</th>
                <th>İndirimli (₺)</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- Veriler JS ile eklenecek -->
        </tbody>
    </table>

    <script>
        const officialRates = {
            2000: 56.00, 2001: 53.20, 2002: 59.00, 2003: 28.50,
            2004: 11.20, 2005: 9.80, 2006: 7.80, 2007: 7.20,
            2008: 12.00, 2009: 2.20, 2010: 7.70, 2011: 10.26,
            2012: 7.80, 2013: 3.93, 2014: 10.11, 2015: 5.58,
            2016: 3.83, 2017: 14.47, 2018: 23.73, 2019: 22.58,
            2020: 9.11, 2021: 36.20, 2022: 122.93, 2023: 58.46,
            2024: 43.93, 2025: 0
        };

        function createTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            for(let year = 2000; year <= 2025; year++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${year}</td>
                    <td class="highlight">${officialRates[year]?.toFixed(2).replace('.', ',') + '%' || '-'}</td>
                    <td><input class="ipc-input currency" type="text" value="${year === 2000 ? '100,00 ₺' : ''}"></td>
                    <td class="rounded-value currency">${year === 2000 ? '75 ₺' : ''}</td>
                `;
                tbody.appendChild(row);
            }

            // Event listener'ları ekle
            tbody.querySelectorAll('.ipc-input').forEach((input, index) => {
                input.addEventListener('focus', function(e) {
                    e.target.select();
                });

                input.addEventListener('blur', function(e) {
                    updateCurrentRow(e.target, index);
                });

                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.target.blur();
                    }
                });
            });

            // İlk hesaplamayı yap
            updateAllCalculations(0);
        }

        function parseTurkishNumber(value) {
            return parseFloat(value.replace(/\./g, '').replace(',', '.'));
        }

        function formatTurkishNumber(value) {
            return new Intl.NumberFormat('tr-TR', { 
                style: 'decimal', 
                minimumFractionDigits: 2,
                maximumFractionDigits: 2 
            }).format(value);
        }

        // Mevcut satırı güncelle
        function updateCurrentRow(input, index) {
            const row = input.closest('tr');
            const rawValue = parseTurkishNumber(input.value) || 0;
            const flooredValue = Math.floor(rawValue);
            
            // Aynı satırdaki Tam Lira'yı güncelle (%75 oranında)
            row.querySelector('.rounded-value').textContent = 
                new Intl.NumberFormat('tr-TR').format(flooredValue * 0.75) + ' ₺';
            input.value = formatTurkishNumber(flooredValue);

            // Tüm hesaplamaları yeniden yap
            updateAllCalculations(index);
        }

        // Tüm hesaplamaları yeniden yap
        function updateAllCalculations(startIndex) {
            const rows = document.querySelectorAll('#tableBody tr');
            let currentValue = parseTurkishNumber(rows[startIndex].querySelector('.ipc-input').value);
            
            for(let i = startIndex + 1; i < rows.length; i++) {
                const rate = officialRates[2000 + i - 1] / 100;
                currentValue = Math.floor(currentValue * (1 + rate));
                
                const input = rows[i].querySelector('.ipc-input');
                const roundedCell = rows[i].querySelector('.rounded-value');
                
                input.value = formatTurkishNumber(currentValue) + ' ₺';
                roundedCell.textContent = new Intl.NumberFormat('tr-TR').format(Math.floor(currentValue * 0.75)) + ' ₺';
            }
        }

        window.onload = createTable;
    </script>
</body>
</html>